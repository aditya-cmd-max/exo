<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>El Futuro - Next-Gen AI Assistant</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/night-owl.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <style>
        :root {
            --primary: #6366f1;
            --primary-light: #818cf8;
            --secondary: #10b981;
            --accent: #f59e0b;
            --dark: #0f172a;
            --darker: #020617;
            --light: #f8fafc;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background: radial-gradient(circle at 10% 20%, var(--darker), var(--dark));
            color: var(--light);
            overscroll-behavior: none;
        }
        
        .glass-panel {
            background: rgba(15, 23, 42, 0.7);
            backdrop-filter: blur(24px);
            -webkit-backdrop-filter: blur(24px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25), 
                        inset 0 1px 0 0 rgba(255, 255, 255, 0.05);
        }
        
        .gradient-text {
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
        }
        
        .message-bubble {
            position: relative;
            overflow: hidden;
        }
        
        .message-bubble::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(129, 140, 248, 0.05));
            z-index: -1;
        }
        
        .typing-indicator span {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: var(--primary-light);
            margin: 0 2px;
        }
        
        #chat-window::-webkit-scrollbar {
            width: 6px;
        }
        
        #chat-window::-webkit-scrollbar-track {
            background: transparent;
        }
        
        #chat-window::-webkit-scrollbar-thumb {
            background-color: rgba(255, 255, 255, 0.15);
            border-radius: 20px;
        }
        
        .code-block {
            position: relative;
            border-radius: 12px;
            overflow: hidden;
        }
        
        .code-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 12px;
            background: rgba(15, 23, 42, 0.8);
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        .copy-btn {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: rgba(255, 255, 255, 0.7);
            padding: 4px 10px;
            border-radius: 6px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 4px;
        }
        
        .copy-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            color: white;
        }
        
        .copy-btn.copied {
            background: var(--secondary);
            color: white;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-8px); }
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .message-animation {
            animation: fadeInUp 0.6s cubic-bezier(0.16, 1, 0.3, 1) forwards;
        }
        
        .feature-btn {
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }
        
        .feature-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: all 0.6s ease;
        }
        
        .feature-btn:hover::before {
            left: 100%;
        }
        
        .feature-btn.active {
            background: rgba(99, 102, 241, 0.2);
            border: 1px solid var(--primary);
            color: white;
            box-shadow: 0 0 15px rgba(99, 102, 241, 0.3);
        }
        
        .input-field {
            transition: all 0.3s ease;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        
        .input-field:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.3);
        }
        
        .send-btn {
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .send-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(99, 102, 241, 0.3);
        }
        
        .send-btn:active {
            transform: translateY(0);
        }
        
        .ai-avatar {
            animation: float 3s ease-in-out infinite;
        }
        
        .user-avatar {
            background: linear-gradient(135deg, #64748b, #475569);
        }
        
        .pulse-animation {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        
        .glow {
            filter: drop-shadow(0 0 8px rgba(99, 102, 241, 0.5));
        }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center p-4">
    <div class="glass-panel w-full max-w-3xl h-[95vh] flex flex-col rounded-2xl overflow-hidden transform transition-all duration-300">
        <!-- Header -->
        <header class="p-5 border-b border-white/10 flex items-center justify-between">
            <div class="flex items-center gap-3">
                <div class="ai-avatar w-10 h-10 rounded-full gradient-bg flex items-center justify-center">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-white">
                        <path d="M12 8V4H8"/>
                        <rect width="16" height="12" x="4" y="8" rx="2"/>
                        <path d="M2 14h2"/>
                        <path d="M20 14h2"/>
                        <path d="M15 13v2"/>
                        <path d="M9 13v2"/>
                    </svg>
                </div>
                <h1 class="text-2xl font-bold gradient-text">El Futuro</h1>
            </div>
            <div class="flex items-center gap-2">
                <div class="w-3 h-3 rounded-full bg-green-500 pulse-animation"></div>
                <span class="text-sm text-gray-400">AI Online</span>
            </div>
        </header>
        
        <!-- Chat Window -->
        <main id="chat-window" class="flex-1 p-5 overflow-y-auto space-y-6">
            <!-- Welcome Message -->
            <div class="flex items-start gap-4 message-animation" style="animation-delay: 0.1s;">
                <div class="ai-avatar shrink-0">
                    <div class="w-10 h-10 rounded-full gradient-bg flex items-center justify-center">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M12 8V4H8"/>
                            <rect width="16" height="12" x="4" y="8" rx="2"/>
                            <path d="M2 14h2"/>
                            <path d="M20 14h2"/>
                            <path d="M15 13v2"/>
                            <path d="M9 13v2"/>
                        </svg>
                    </div>
                </div>
                <div class="message-bubble bg-gray-800/50 rounded-2xl p-4 max-w-[85%]">
                    <p class="text-gray-100">Hello! I'm <span class="font-semibold text-indigo-300">El Futuro</span>, your next-generation AI assistant. üåü</p>
                    <p class="text-gray-300 mt-2">I can help with brainstorming, code explanation, creative writing, and much more. What would you like to explore today?</p>
                    <div class="mt-3 pt-3 border-t border-gray-700/50">
                        <p class="text-xs text-gray-400">Try one of these quick starters:</p>
                        <div class="flex flex-wrap gap-2 mt-2">
                            <button class="quick-prompt text-xs px-3 py-1.5 bg-gray-700/50 hover:bg-gray-700 rounded-lg transition-all" data-prompt="Suggest innovative AI project ideas">üí° Project ideas</button>
                            <button class="quick-prompt text-xs px-3 py-1.5 bg-gray-700/50 hover:bg-gray-700 rounded-lg transition-all" data-prompt="Explain how neural networks work">üß† Explain AI</button>
                            <button class="quick-prompt text-xs px-3 py-1.5 bg-gray-700/50 hover:bg-gray-700 rounded-lg transition-all" data-prompt="Help me debug this Python code">üêç Debug code</button>
                        </div>
                    </div>
                </div>
            </div>
        </main>
        
        <!-- Input Area -->
        <div class="p-5 border-t border-white/10">
            <!-- Feature Buttons -->
            <div id="feature-buttons" class="flex items-center gap-3 mb-4">
                <button id="brainstorm-btn" class="feature-btn flex-1 text-sm py-2.5 px-4 bg-gray-800/50 hover:bg-gray-700 rounded-xl border border-gray-700 transition-all">
                    <div class="flex items-center justify-center gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-yellow-400">
                            <path d="M12 2v4"/>
                            <path d="m5.2 5.2 2.8 2.8"/>
                            <path d="M18 8a10 10 0 1 1-4 8"/>
                        </svg>
                        <span>Brainstorm</span>
                    </div>
                </button>
                <button id="explain-btn" class="feature-btn flex-1 text-sm py-2.5 px-4 bg-gray-800/50 hover:bg-gray-700 rounded-xl border border-gray-700 transition-all">
                    <div class="flex items-center justify-center gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-blue-400">
                            <circle cx="12" cy="12" r="10"/>
                            <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/>
                            <path d="M12 17h.01"/>
                        </svg>
                        <span>Explain Code</span>
                    </div>
                </button>
                <button id="creative-btn" class="feature-btn flex-1 text-sm py-2.5 px-4 bg-gray-800/50 hover:bg-gray-700 rounded-xl border border-gray-700 transition-all">
                    <div class="flex items-center justify-center gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-purple-400">
                            <path d="M12 2v4"/>
                            <path d="m5.2 5.2 2.8 2.8"/>
                            <path d="M18 8a10 10 0 1 1-4 8"/>
                        </svg>
                        <span>Creative</span>
                    </div>
                </button>
            </div>
            
            <!-- Input Form -->
            <form id="chat-form" class="flex items-end gap-3">
                <div class="flex-1 relative">
                    <textarea id="message-input" rows="1" class="input-field w-full bg-gray-800/50 border border-gray-700 rounded-xl p-4 pr-12 resize-none focus:outline-none focus:ring-2 focus:ring-indigo-500/30 text-gray-200 placeholder-gray-500 transition-all" placeholder="Message El Futuro..."></textarea>
                    <button type="button" id="clear-input" class="absolute right-3 bottom-3 text-gray-500 hover:text-gray-300 transition-colors hidden">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <line x1="18" y1="6" x2="6" y2="18"/>
                            <line x1="6" y1="6" x2="18" y2="18"/>
                        </svg>
                    </button>
                </div>
                <button type="submit" class="send-btn h-12 w-12 gradient-bg hover:bg-indigo-500 transition-all rounded-xl flex items-center justify-center shrink-0 glow">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-white">
                        <line x1="22" y1="2" x2="11" y2="13"/>
                        <polygon points="22 2 15 22 11 13 2 9 22 2"/>
                    </svg>
                </button>
            </form>
            
            <!-- Footer -->
            <footer class="text-center text-xs text-gray-500 mt-4 pt-4 border-t border-gray-800/50">
                <p>El Futuro may produce inaccurate information. Verify critical information.</p>
                <p class="mt-1">Made with <span class="text-red-400">‚ù§Ô∏è</span> by Aditya Jha</p>
            </footer>
        </div>
    </div>

    <script>
        // DOM Elements
        const chatWindow = document.getElementById('chat-window');
        const chatForm = document.getElementById('chat-form');
        const messageInput = document.getElementById('message-input');
        const clearInputBtn = document.getElementById('clear-input');
        const brainstormBtn = document.getElementById('brainstorm-btn');
        const explainBtn = document.getElementById('explain-btn');
        const creativeBtn = document.getElementById('creative-btn');
        const featureButtons = [brainstormBtn, explainBtn, creativeBtn];
        const quickPrompts = document.querySelectorAll('.quick-prompt');

        // State
        let currentMode = 'chat'; // 'chat', 'brainstorm', 'explain', 'creative'
        let isWaitingForResponse = false;

        // Chat history with system prompt
        let chatHistory = [{
            role: "model",
            parts: [{ 
                text: "You are El Futuro, an advanced AI assistant created by Aditya Jha. Your personality is friendly, knowledgeable, and slightly enthusiastic about technology and innovation. Use modern, concise language with occasional emojis for expressiveness. Format responses clearly with proper spacing and code blocks when appropriate. For coding questions, provide detailed explanations with examples. For creative requests, offer multiple options or approaches. Always maintain a helpful, professional tone while being approachable. Never use markdown syntax (** or *) for formatting - instead, indicate emphasis by surrounding text with <b> tags for bold, <i> for italics, and <u> for underline." 
            }]
        }];

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            // Initialize syntax highlighting
            hljs.highlightAll();
            
            // Add floating animation to welcome message
            gsap.from('.message-animation', {
                duration: 0.6,
                y: 20,
                opacity: 0,
                stagger: 0.1,
                ease: "power2.out"
            });
        });

        // Event Listeners
        brainstormBtn.addEventListener('click', () => setMode('brainstorm'));
        explainBtn.addEventListener('click', () => setMode('explain'));
        creativeBtn.addEventListener('click', () => setMode('creative'));

        quickPrompts.forEach(btn => {
            btn.addEventListener('click', (e) => {
                messageInput.value = e.target.dataset.prompt;
                messageInput.focus();
                updateInputHeight();
            });
        });

        messageInput.addEventListener('input', () => {
            updateInputHeight();
            clearInputBtn.style.display = messageInput.value.trim() ? 'block' : 'none';
        });

        clearInputBtn.addEventListener('click', () => {
            messageInput.value = '';
            updateInputHeight();
            clearInputBtn.style.display = 'none';
            messageInput.focus();
        });

        chatForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const userMessage = messageInput.value.trim();
            
            if (userMessage && !isWaitingForResponse) {
                await sendMessage(userMessage);
                messageInput.value = '';
                updateInputHeight();
                clearInputBtn.style.display = 'none';
                setMode('chat'); // Reset to default chat mode after sending
            }
        });

        // Functions
        function updateInputHeight() {
            messageInput.style.height = 'auto';
            const newHeight = Math.min(messageInput.scrollHeight, 150);
            messageInput.style.height = `${newHeight}px`;
        }

        function setMode(newMode) {
            // Toggle mode if clicking the same button
            currentMode = currentMode === newMode ? 'chat' : newMode;
            updateUIForMode();
            
            // Animate the active button
            featureButtons.forEach(btn => {
                gsap.to(btn, {
                    duration: 0.3,
                    backgroundColor: btn.id === `${newMode}-btn` && currentMode === newMode ? 'rgba(99, 102, 241, 0.2)' : 'rgba(30, 41, 59, 0.5)',
                    borderColor: btn.id === `${newMode}-btn` && currentMode === newMode ? 'rgba(99, 102, 241, 0.8)' : 'rgba(55, 65, 81, 0.5)',
                    ease: "power2.out"
                });
            });
        }

        function updateUIForMode() {
            let placeholderText = 'Message El Futuro...';
            
            switch (currentMode) {
                case 'brainstorm':
                    placeholderText = 'What would you like to brainstorm about?';
                    break;
                case 'explain':
                    placeholderText = 'Paste code to explain (supports 20+ languages)';
                    break;
                case 'creative':
                    placeholderText = 'What creative project can I help with?';
                    break;
            }
            
            messageInput.placeholder = placeholderText;
            messageInput.focus();
        }

        async function sendMessage(message) {
            isWaitingForResponse = true;
            displayUserMessage(message);
            
            let apiPrompt = message;
            if (currentMode === 'brainstorm') {
                apiPrompt = `Brainstorm diverse and innovative ideas about: "${message}". Provide a numbered list of at least 5 creative suggestions with brief explanations for each.`;
            } else if (currentMode === 'explain') {
                apiPrompt = `Explain the following code in detail. Break it down section by section, describe what each part does, and provide a summary of its overall functionality:\n\n\`\`\`\n${message}\n\`\`\``;
            } else if (currentMode === 'creative') {
                apiPrompt = `Provide creative assistance for: "${message}". Offer multiple approaches, examples, or variations as appropriate. Be imaginative yet practical.`;
            }
            
            chatHistory.push({ role: "user", parts: [{ text: apiPrompt }] });
            await getBotResponse();
            isWaitingForResponse = false;
        }

        function displayUserMessage(message) {
            const messageElement = document.createElement('div');
            messageElement.className = 'flex items-start gap-4 justify-end';
            
            gsap.set(messageElement, { opacity: 0, y: 20 });
            
            messageElement.innerHTML = `
                <div class="message-bubble bg-indigo-600/20 rounded-2xl p-4 max-w-[85%] border border-indigo-500/20">
                    <p class="text-white">${escapeHtml(message)}</p>
                </div>
                <div class="user-avatar w-10 h-10 rounded-full flex items-center justify-center font-medium text-sm shrink-0">You</div>
            `;
            
            chatWindow.appendChild(messageElement);
            gsap.to(messageElement, {
                duration: 0.6,
                opacity: 1,
                y: 0,
                ease: "power2.out",
                onComplete: () => chatWindow.scrollTop = chatWindow.scrollHeight
            });
        }

        function displayBotMessage(message) {
            const messageContainer = document.createElement('div');
            messageContainer.className = 'flex items-start gap-4';
            
            gsap.set(messageContainer, { opacity: 0, y: 20 });
            
            let botMessageContent = '';
            const codeBlockRegex = /```(\w*)\n([\s\S]*?)```/g;
            let lastIndex = 0;
            let match;
            
            // Process message for code blocks
            while ((match = codeBlockRegex.exec(message)) !== null) {
                // Add text before code block
                if (match.index > lastIndex) {
                    const textPart = message.substring(lastIndex, match.index).trim();
                    if (textPart) {
                        botMessageContent += `<p class="text-gray-100">${formatTextWithLinks(textPart)}</p>`;
                    }
                }
                
                // Add code block
                const language = match[1] || 'plaintext';
                const code = match[2];
                const uniqueId = `code-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;
                
                botMessageContent += `
                    <div class="code-block mt-3 mb-4 w-full overflow-hidden rounded-xl">
                        <div class="code-header">
                            <span class="text-xs font-mono text-gray-400">${language}</span>
                            <button class="copy-btn" onclick="copyCode('${uniqueId}', this)" title="Copy code">
                                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <rect x="9" y="9" width="13" height="13" rx="2" ry="2"/>
                                    <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/>
                                </svg>
                                <span>Copy</span>
                            </button>
                        </div>
                        <pre class="m-0 p-4 bg-gray-900/80 overflow-x-auto"><code id="${uniqueId}" class="language-${language}">${escapeHtml(code)}</code></pre>
                    </div>`;
                
                lastIndex = match.index + match[0].length;
            }
            
            // Add remaining text after last code block
            if (lastIndex < message.length) {
                const textPart = message.substring(lastIndex).trim();
                if (textPart) {
                    botMessageContent += `<p class="text-gray-100">${formatTextWithLinks(textPart)}</p>`;
                }
            }
            
            messageContainer.innerHTML = `
                <div class="ai-avatar shrink-0">
                    <div class="w-10 h-10 rounded-full gradient-bg flex items-center justify-center">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M12 8V4H8"/>
                            <rect width="16" height="12" x="4" y="8" rx="2"/>
                            <path d="M2 14h2"/>
                            <path d="M20 14h2"/>
                            <path d="M15 13v2"/>
                            <path d="M9 13v2"/>
                        </svg>
                    </div>
                </div>
                <div class="message-bubble flex-1 bg-gray-800/50 rounded-2xl p-4 max-w-[85%]">
                    ${botMessageContent}
                    <div class="mt-3 pt-3 border-t border-gray-700/50 flex justify-end">
                        <button class="feedback-btn text-xs px-2 py-1 bg-gray-700/30 hover:bg-gray-700/50 rounded-md transition-all flex items-center gap-1" onclick="provideFeedback(this)">
                            <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M7 10v12"/>
                                <path d="M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a3.13 3.13 0 0 1 3 3.88Z"/>
                            </svg>
                            <span>Helpful?</span>
                        </button>
                    </div>
                </div>`;
            
            chatWindow.appendChild(messageContainer);
            
            // Animate message in
            gsap.to(messageContainer, {
                duration: 0.6,
                opacity: 1,
                y: 0,
                ease: "power2.out",
                onComplete: () => {
                    chatWindow.scrollTop = chatWindow.scrollHeight;
                    // Highlight any code blocks
                    document.querySelectorAll('pre code').forEach(block => {
                        hljs.highlightElement(block);
                    });
                }
            });
        }

        function displayTypingIndicator() {
            const typingElement = document.createElement('div');
            typingElement.id = 'typing-indicator';
            typingElement.className = 'flex items-start gap-4';
            
            typingElement.innerHTML = `
                <div class="ai-avatar shrink-0">
                    <div class="w-10 h-10 rounded-full gradient-bg flex items-center justify-center">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M12 8V4H8"/>
                            <rect width="16" height="12" x="4" y="8" rx="2"/>
                            <path d="M2 14h2"/>
                            <path d="M20 14h2"/>
                            <path d="M15 13v2"/>
                            <path d="M9 13v2"/>
                        </svg>
                    </div>
                </div>
                <div class="message-bubble bg-gray-800/50 rounded-2xl p-4 max-w-[85%]">
                    <div class="typing-indicator flex items-center space-x-1.5">
                        <span></span>
                        <span></span>
                        <span></span>
                    </div>
                </div>`;
            
            chatWindow.appendChild(typingElement);
            chatWindow.scrollTop = chatWindow.scrollHeight;
            
            // Animate in
            gsap.from(typingElement, {
                duration: 0.4,
                opacity: 0,
                y: 10,
                ease: "power2.out"
            });
        }

        function removeTypingIndicator() {
            const typingIndicator = document.getElementById('typing-indicator');
            if (typingIndicator) {
                gsap.to(typingIndicator, {
                    duration: 0.3,
                    opacity: 0,
                    y: -10,
                    ease: "power2.in",
                    onComplete: () => typingIndicator.remove()
                });
            }
        }

        async function getBotResponse() {
            displayTypingIndicator();
            
            const apiKey = "AIzaSyDumsAxfOETUy3E85Qp_ikVSglQmeoXrJk";
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;
            const payload = { contents: chatHistory };
            
            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) {
                    throw new Error(`API Error: ${response.status} ${response.statusText}`);
                }

                const result = await response.json();
                removeTypingIndicator();
                
                if (result.candidates && result.candidates.length > 0) {
                    const botMessage = result.candidates[0].content.parts[0].text;
                    displayBotMessage(botMessage);
                    chatHistory.push({ role: "model", parts: [{ text: botMessage }] });
                } else {
                    handleApiError("I received an empty response. Please try rephrasing your request. ü§î");
                }
            } catch (error) {
                console.error("Fetch Error:", error);
                handleApiError("Sorry, I'm having trouble connecting to the AI service. Please check your connection and try again. üîå");
            }
        }
        
        function handleApiError(message) {
            removeTypingIndicator();
            displayBotMessage(message);
        }

        // Utility Functions
        function escapeHtml(unsafe) {
            return unsafe
                .replace(/&/g, "&amp;")
                .replace(/</g, "&lt;")
                .replace(/>/g, "&gt;")
                .replace(/"/g, "&quot;")
                .replace(/'/g, "&#039;");
        }
        
        function formatTextWithLinks(text) {
            // Convert markdown links to HTML
            return text.replace(/\[([^\]]+)\]\(([^)]+)\)/g, '<a href="$2" target="_blank" rel="noopener noreferrer" class="text-indigo-400 hover:underline">$1</a>')
                       .replace(/\n/g, '<br>');
        }
        
        // Global functions
        window.copyCode = function(elementId, buttonElement) {
            const codeElement = document.getElementById(elementId);
            const textToCopy = codeElement.innerText;
            
            navigator.clipboard.writeText(textToCopy).then(() => {
                const buttonSpan = buttonElement.querySelector('span');
                const originalText = buttonSpan.innerText;
                
                buttonElement.classList.add('copied');
                buttonSpan.innerText = 'Copied!';
                
                gsap.to(buttonElement, {
                    duration: 0.3,
                    backgroundColor: 'rgba(16, 185, 129, 0.2)',
                    borderColor: 'rgba(16, 185, 129, 0.5)',
                    color: 'white',
                    ease: "power2.out"
                });
                
                setTimeout(() => {
                    buttonSpan.innerText = originalText;
                    buttonElement.classList.remove('copied');
                    gsap.to(buttonElement, {
                        duration: 0.3,
                        backgroundColor: 'rgba(255, 255, 255, 0.05)',
                        borderColor: 'rgba(255, 255, 255, 0.1)',
                        color: 'rgba(255, 255, 255, 0.7)',
                        ease: "power2.out"
                    });
                }, 2000);
            }).catch(err => {
                console.error('Failed to copy text: ', err);
            });
        }
        
        window.provideFeedback = function(buttonElement) {
            buttonElement.innerHTML = `
                <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                    <polyline points="22 4 12 14.01 9 11.01"/>
                </svg>
                <span>Thank you!</span>
            `;
            
            gsap.to(buttonElement, {
                duration: 0.3,
                backgroundColor: 'rgba(16, 185, 129, 0.2)',
                color: 'rgb(16, 185, 129)',
                ease: "power2.out"
            });
        }
    </script>
</body>
</html>
